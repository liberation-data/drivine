(function($){var hiddenFix=function(){return{tmp:[],hidden:null,adjust:function($child){var _self=this;_self.hidden=$child.parents().andSelf().filter(":hidden");_self.hidden.each(function(){var $elem=$(this);_self.tmp.push($elem.attr("style"));$elem.css({visibility:"hidden",display:"block"})})},reset:function(){var _self=this;_self.hidden.each(function(i){var $elem=$(this),_tmp=_self.tmp[i];if(_tmp===undefined)$elem.removeAttr("style");else $elem.attr("style",_tmp)});_self.tmp=[];_self.hidden=null}}};jQuery.foundation=jQuery.foundation||{};jQuery.foundation.customForms=jQuery.foundation.customForms||{};$.foundation.customForms.appendCustomMarkup=function(options){var defaults={disable_class:"js-disable-custom"};options=$.extend(defaults,options);function appendCustomMarkup(idx,sel){var $this=$(sel).hide(),type=$this.attr("type"),$span=$this.next("span.custom."+type);if($span.length===0){$span=$('<span class="custom '+type+'"></span>').insertAfter($this)}$span.toggleClass("checked",$this.is(":checked"));$span.toggleClass("disabled",$this.is(":disabled"))}function appendCustomSelect(idx,sel){var hiddenFixObj=hiddenFix();var $this=$(sel),$customSelect=$this.next("div.custom.dropdown"),$customList=$customSelect.find("ul"),$selectCurrent=$customSelect.find(".current"),$selector=$customSelect.find(".selector"),$options=$this.find("option"),$selectedOption=$options.filter(":selected"),maxWidth=0,liHtml="",$listItems;var $currentSelect=false;if($this.hasClass("no-custom"))return;if($customSelect.length===0){var customSelectSize=$this.hasClass("small")?"small":$this.hasClass("medium")?"medium":$this.hasClass("large")?"large":$this.hasClass("expand")?"expand":"";$customSelect=$('<div class="'+["custom","dropdown",customSelectSize].join(" ")+'"><a href="#" class="selector"></a><ul /></div>"');$selector=$customSelect.find(".selector");$customList=$customSelect.find("ul");liHtml=$options.map(function(){return"<li>"+$(this).html()+"</li>"}).get().join("");$customList.append(liHtml);$currentSelect=$customSelect.prepend('<a href="#" class="current">'+$selectedOption.html()+"</a>").find(".current");$this.after($customSelect).hide()}else{liHtml=$options.map(function(){return"<li>"+$(this).html()+"</li>"}).get().join("");$customList.html("").append(liHtml)}$customSelect.toggleClass("disabled",$this.is(":disabled"));$listItems=$customList.find("li");$options.each(function(index){if(this.selected){$listItems.eq(index).addClass("selected");if($currentSelect){$currentSelect.html($(this).html())}}});$customList.css("width","inherit");$customSelect.css("width","inherit");if(!$customSelect.is(".small, .medium, .large, .expand")){$customSelect.addClass("open");hiddenFixObj.adjust($customList);maxWidth=$listItems.outerWidth()>maxWidth?$listItems.outerWidth():maxWidth;hiddenFixObj.reset();$customSelect.removeClass("open");$customSelect.width(maxWidth+18);$customList.width(maxWidth+16)}}$("form.custom input:radio[data-customforms!=disabled]").each(appendCustomMarkup);$("form.custom input:checkbox[data-customforms!=disabled]").each(appendCustomMarkup);$("form.custom select[data-customforms!=disabled]").each(appendCustomSelect)};var refreshCustomSelect=function($select){var maxWidth=0,$customSelect=$select.next();$options=$select.find("option");$customSelect.find("ul").html("");$options.each(function(){$li=$("<li>"+$(this).html()+"</li>");$customSelect.find("ul").append($li)});$options.each(function(index){if(this.selected){$customSelect.find("li").eq(index).addClass("selected");$customSelect.find(".current").html($(this).html())}});$customSelect.removeAttr("style").find("ul").removeAttr("style");$customSelect.find("li").each(function(){$customSelect.addClass("open");if($(this).outerWidth()>maxWidth){maxWidth=$(this).outerWidth()}$customSelect.removeClass("open")});$customSelect.css("width",maxWidth+18+"px");$customSelect.find("ul").css("width",maxWidth+16+"px")};var toggleCheckbox=function($element){var $input=$element.prev(),input=$input[0];if(false===$input.is(":disabled")){input.checked=input.checked?false:true;$element.toggleClass("checked");$input.trigger("change")}};var toggleRadio=function($element){var $input=$element.prev(),$form=$input.closest("form.custom"),input=$input[0];if(false===$input.is(":disabled")){$form.find('input:radio[name="'+$input.attr("name")+'"]').next().not($element).removeClass("checked");if(!$element.hasClass("checked")){$element.toggleClass("checked")}input.checked=$element.hasClass("checked");$input.trigger("change")}};$(document).on("click","form.custom span.custom.checkbox",function(event){event.preventDefault();event.stopPropagation();toggleCheckbox($(this))});$(document).on("click","form.custom span.custom.radio",function(event){event.preventDefault();event.stopPropagation();toggleRadio($(this))});$(document).on("change","form.custom select[data-customforms!=disabled]",function(event){refreshCustomSelect($(this))});$(document).on("click","form.custom label",function(event){var $associatedElement=$("#"+$(this).attr("for")+"[data-customforms!=disabled]"),$customCheckbox,$customRadio;if($associatedElement.length!==0){if($associatedElement.attr("type")==="checkbox"){event.preventDefault();$customCheckbox=$(this).find("span.custom.checkbox");toggleCheckbox($customCheckbox)}else if($associatedElement.attr("type")==="radio"){event.preventDefault();$customRadio=$(this).find("span.custom.radio");toggleRadio($customRadio)}}});$(document).on("click","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(event){var $this=$(this),$dropdown=$this.closest("div.custom.dropdown"),$select=$dropdown.prev();event.preventDefault();$("div.dropdown").removeClass("open");if(false===$select.is(":disabled")){$dropdown.toggleClass("open");if($dropdown.hasClass("open")){$(document).bind("click.customdropdown",function(event){$dropdown.removeClass("open");$(document).unbind(".customdropdown")})}else{$(document).unbind(".customdropdown")}return false}});$(document).on("click","form.custom div.custom.dropdown li",function(event){var $this=$(this),$customDropdown=$this.closest("div.custom.dropdown"),$select=$customDropdown.prev(),selectedIndex=0;event.preventDefault();event.stopPropagation();$("div.dropdown").removeClass("open");$this.closest("ul").find("li").removeClass("selected");$this.addClass("selected");$customDropdown.removeClass("open").find("a.current").html($this.html());$this.closest("ul").find("li").each(function(index){if($this[0]==this){selectedIndex=index}});$select[0].selectedIndex=selectedIndex;$select.trigger("change")});$.fn.foundationCustomForms=$.foundation.customForms.appendCustomMarkup})(jQuery);